name: WindowsReleaseTest

on:  
  pull_request:
  schedule:
    - cron: '0 8 * * 1'

jobs:
  windows_test:
    runs-on: windows-latest

    steps:
      - uses: actions/checkout@v3
      
      - name: Install QGIS on Chocolatey
        uses: crazy-max/ghaction-chocolatey@v3
        with:
          args: install qgis-ltr -y

      - name: Plugin install
        shell: pwsh
        run: |
          Copy-Item "qaequilibrae" -Destination "$env:APPDATA\QGIS\QGIS3\profiles\default\python\plugins" -Recurse
          python-qgis-ltr.bat ci/dependency_installation.py
        # $env:PATH=(Get-ChildItem -Path "C:\Program Files" -Directory QGIS*).FullName +"\bin;$env:PATH"
        # $env:QGIS_PLUGIN_IN_CI=1
        # python-qgis-ltr.bat -m pip list
        # python-qgis-ltr.bat -m pip install -r test/requirements-test.txt
        # python-qgis-ltr.bat -m pip list
        # python-qgis-ltr.bat -m pytest test -v --tb=short --cov=qaequilibrae
          